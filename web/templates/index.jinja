  <!-- Extern√≠ knihovny -->

  <!-- Extern√≠ knihovny -->
  

{% extends "_base.jinja" %}

{# ============================================================
   Dashboard layout
   ------------------------------------------------------------
   √öƒçel:
   - Roz≈°i≈ôuje z√°kladn√≠ ≈°ablonu _base.jinja.
   - Definuje title, navbar, sidebar, skripty a hlavn√≠ obsah.
   - Obsah se dynamicky mƒõn√≠ podle role u≈æivatele (admin vs. user).
   ============================================================ #}

{% block title %}Dashboard{% endblock %}
{% block navbar_title %}Dashboard{% endblock %}

{% block head_links %}
<!-- Nastaven√≠ motivu hned na zaƒç√°tku -->
  <script>
    const savedTheme = localStorage.getItem('theme')
      || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    document.documentElement.setAttribute('data-bs-theme', savedTheme);
  </script>
  
  <!-- Extern√≠ knihovny (Bootstrap, Bootstrap Icons) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
        crossorigin="anonymous">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
        integrity="sha384-Ay26V7L8bsJTsX9Sxclnvsn+hkdiwRnrjZJXqKmkIDobPgIIWBOVguEcQQLDuhfN"
        crossorigin="anonymous">

  <!-- Vlastn√≠ styly -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/layout.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/components.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/darkmode.css') }}">

  <!-- Favikon (svƒõtl√Ω/tmav√Ω re≈æim) -->
  {% if favicon_light %}
  <link rel="icon" href="{{ url_for('static', filename=favicon_light) }}" type="image/png">
  {% endif %}
  {% if favicon_dark %}
  <link rel="icon" href="{{ url_for('static', filename=favicon_dark) }}" type="image/png" media="(prefers-color-scheme: dark)">
  {% endif %}

{% endblock %}

{% block scripts %}
  <!-- Extern√≠ knihovny -->
  <script src="https://cdn.plot.ly/plotly-2.24.1.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
          crossorigin="anonymous"></script>
  
  <!-- Vlastn√≠ skripty -->
  <script src="{{ url_for('static', filename='js/theme.js') }}" defer></script>
  <!-- Modul√°rn√≠ logika -->
  <script type="module" src="{{ url_for('static', filename='js/bootstrap.js') }}"></script>
  <script type="module" src="{{ url_for('static', filename='js/plot.js') }}"></script>
  <script type="module" src="{{ url_for('static', filename='js/actuators.js') }}"></script>
{% endblock %}

{% block sidebar %}
  <!-- Sidebar (menu + u≈æivatel) -->
  {% include "_sidebar.jinja" %}
{% endblock %}

{% block navbar_right %}
  <!-- Logo + p≈ôep√≠naƒç motivu -->
  <img src="{{ url_for('static', filename='img/logo.png') }}"
       alt="Logo organizace" width="24" height="24" class="me-2">

  <button id="theme-toggle" class="btn btn-sm btn-outline-secondary" type="button" aria-label="P≈ôepnout motiv">
    <span class="theme-icon">üåô</span>
  </button>
{% endblock %}

{% block content %}
  <!-- Sekce nastaven√≠ -->
  {% include "_settings.jinja" %}

  <!-- Aktu√°tory (admin ‚Üí nastaven√≠, user ‚Üí status) -->
  {% if role == "admin" %}
    {% include "actuators/_settings.jinja" %}
  {% else %}  
    {% include "actuators/_status.jinja" %}
  {% endif %}  

  <!-- Senzory (aktu√°ln√≠ stav + historie) -->
  {% include "sensors/_current.jinja" %}
  {% include "sensors/_history.jinja" %}

  <!-- Logy (jen pro admina) -->
  {% if role == "admin" %}
    {% include "_logs.jinja" %}
  {% endif %}  
{% endblock %}

{% block modals %}
<!-- Modal: Style Guide -->
<div class="modal fade" id="styleguideModal" tabindex="-1" aria-labelledby="styleguideLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="styleguideLabel">üé® Style Guide</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zav≈ô√≠t"></button>
      </div>
      <div class="modal-body p-0">
        <iframe src="{{ url_for('styleguide') }}" style="width:100%; height:80vh; border:none;"></iframe>
      </div>
    </div>
  </div>
</div>
{% endblock %}